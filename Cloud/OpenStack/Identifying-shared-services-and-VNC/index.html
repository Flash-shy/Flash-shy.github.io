<!DOCTYPE html><html lang="en-GB" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>OpenStack Series Chapter4: Identifying shared services and VNC | Haoyang Sun's Blog</title><meta name="author" content="Haoyang Sun"><meta name="copyright" content="Haoyang Sun"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="This article mainly introduces the shared services running on the controller node and the process of VNC.">
<meta property="og:type" content="article">
<meta property="og:title" content="OpenStack Series Chapter4: Identifying shared services and VNC">
<meta property="og:url" content="https://www.sunhaoyang.net/Cloud/OpenStack/Identifying-shared-services-and-VNC/index.html">
<meta property="og:site_name" content="Haoyang Sun&#39;s Blog">
<meta property="og:description" content="This article mainly introduces the shared services running on the controller node and the process of VNC.">
<meta property="og:locale" content="en_GB">
<meta property="og:image" content="https://blog.sunhaoyang.net/images/OpenStack.png">
<meta property="article:published_time" content="2025-05-07T09:16:17.000Z">
<meta property="article:modified_time" content="2025-05-09T03:17:54.969Z">
<meta property="article:author" content="Haoyang Sun">
<meta property="article:tag" content="OpenStack">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.sunhaoyang.net/images/OpenStack.png"><link rel="shortcut icon" href="https://blog.sunhaoyang.net/images/favicon.ico"><link rel="canonical" href="https://www.sunhaoyang.net/Cloud/OpenStack/Identifying-shared-services-and-VNC/index.html"><link rel="preconnect"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')
          
          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: '/pluginsSrc/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'OpenStack Series Chapter4: Identifying shared services and VNC',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://blog.sunhaoyang.net/images/myphoto.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">39</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Homepage</span></a></div><div class="menus_item"><a class="site-page" href="/artitalk/"><i class="fa-fw fa fa-comment-alt"></i><span> Artitalk</span></a></div><div class="menus_item"><a class="site-page" href="/about"><i class="fa-fw fa-solid fa-user"></i><span> About the author</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Haoyang Sun's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">OpenStack Series Chapter4: Identifying shared services and VNC</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Homepage</span></a></div><div class="menus_item"><a class="site-page" href="/artitalk/"><i class="fa-fw fa fa-comment-alt"></i><span> Artitalk</span></a></div><div class="menus_item"><a class="site-page" href="/about"><i class="fa-fw fa-solid fa-user"></i><span> About the author</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">OpenStack Series Chapter4: Identifying shared services and VNC</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-05-07T09:16:17.000Z" title="Created 2025-05-07 17:16:17">2025-05-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-05-09T03:17:54.969Z" title="Updated 2025-05-09 11:17:54">2025-05-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Cloud/">Cloud</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">1.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>6mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">Comments:</span><a href="/Cloud/OpenStack/Identifying-shared-services-and-VNC/index.html#post-comment"><span id="twikoo-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div><article class="container post-content" id="article-container"><h2 id="Shared-Services-Overview"><a href="#Shared-Services-Overview" class="headerlink" title="Shared Services Overview"></a>Shared Services Overview</h2><table>
<thead>
<tr>
<th align="left">Service</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody><tr>
<td align="left">MariaDB</td>
<td align="left">A relational database.</td>
</tr>
<tr>
<td align="left">Redis</td>
<td align="left">An in-memory key-value data store.</td>
</tr>
<tr>
<td align="left">memcached</td>
<td align="left">A distributed memory cache.</td>
</tr>
<tr>
<td align="left">Pacemaker</td>
<td align="left">Clustering software.</td>
</tr>
<tr>
<td align="left">Ceph MON and MDS</td>
<td align="left">The Ceph cluster monitor, and Metadata Server.</td>
</tr>
<tr>
<td align="left">NoVNC and Spice</td>
<td align="left">Both provide a remote console for instances.</td>
</tr>
</tbody></table>
<h3 id="MariaDB"><a href="#MariaDB" class="headerlink" title="MariaDB"></a>MariaDB</h3><p><code>MariaDB</code> is an open-source edition SQL database and it’s compatible with MySQL database.</p>
<p>It allows all components to store information.</p>
<p>In the <code>controller node</code>, the method is <code>MariaDB Galera</code>. It provides <code>multi-master replication</code> mode to confirm the stable status, all nodes are the master.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+----------+     +----------+     +----------+</span><br><span class="line">|  Node A  | &lt;--&gt;|  Node B  | &lt;--&gt;|  Node C  |</span><br><span class="line">+----------+     +----------+     +----------+</span><br><span class="line">      ^                              ^</span><br><span class="line">      |                              |</span><br><span class="line">      +-------- Client -------------+</span><br></pre></td></tr></table></figure>

<p>The Features of MariaDB Galera:</p>
<ul>
<li><p>Multi-Master Replication</p>
<ul>
<li><p>All nodes can perform read and write operations simultaneously.</p>
</li>
<li><p>Real-time data synchronisation (synchronous replication, not asynchronous) ensures strong consistency.</p>
</li>
</ul>
</li>
<li><p>Strong Consistency (Synchronous Replication)</p>
<ul>
<li>Uses <strong>write-set replication</strong>: a write operation is considered successful only after all nodes have reached consensus.</li>
</ul>
</li>
<li><p>Automatic Membership Management and Failover</p>
<ul>
<li><p>Nodes can automatically join or leave the cluster.</p>
</li>
<li><p>A single node failure does not render the entire database unavailable.</p>
</li>
</ul>
</li>
<li><p>No Single Point of Failure (Theoretically)</p>
<ul>
<li><p>As long as the majority of nodes (typically N&#x2F;2 + 1) remain operational, the cluster can continue to function.</p>
</li>
<li><p>All nodes act as primary nodes, with strong data synchronisation between them.</p>
</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>Type</th>
<th>Synchronous</th>
<th>Granularity</th>
<th>Characteristics</th>
<th>Common Use Cases</th>
</tr>
</thead>
<tbody><tr>
<td>Statement-based (SBR)</td>
<td>Asynchronous</td>
<td>SQL statements</td>
<td>Fast but may lead to inconsistencies</td>
<td>MySQL</td>
</tr>
<tr>
<td>Row-based (RBR)</td>
<td>Asynchronous</td>
<td>Row-level</td>
<td>Good consistency, high data volume</td>
<td>MySQL</td>
</tr>
<tr>
<td>Mixed-based</td>
<td>Asynchronous</td>
<td>Auto-switching</td>
<td>A compromise between SBR and RBR</td>
<td>MySQL</td>
</tr>
<tr>
<td>Write-set</td>
<td>Synchronous</td>
<td>Transaction write-set</td>
<td>Strong consistency, multi-master</td>
<td>Galera Cluster</td>
</tr>
<tr>
<td>Logical</td>
<td>Sync&#x2F;Async</td>
<td>Table&#x2F;statement-level</td>
<td>Highly flexible</td>
<td>PostgreSQL</td>
</tr>
<tr>
<td>Physical</td>
<td>Synchronous</td>
<td>Binary data</td>
<td>High performance but less flexible</td>
<td>PostgreSQL, Oracle, etc.</td>
</tr>
</tbody></table>
<h3 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h3><p><code>Redis</code> is a <code>high-performance</code> <code>in-memory</code> <code>key-value</code> data store.</p>
<p>It can store several types of data structures, such as <code>strings, lists, sets, sorted sets, and hashes</code>.</p>
<p>Compared with traditional database, Redis uses memory to store data. Therefore, keeping all data in memory increases performance.</p>
<p>What’s more, Redis supports to save data to disk as well.</p>
<h3 id="Memcached"><a href="#Memcached" class="headerlink" title="Memcached"></a>Memcached</h3><p><code>Memcached</code> is similar to <code>Redis</code>, it provides an in-memory cache for ephemeral data.</p>
<p>However, Memcached does not support the persistent storage in disk, it does not support various kinds of data structure(only key-value string).</p>
<p>It’s used more in <code>keystone</code>, <code>nova</code>, <code>oslo</code> and so on.</p>
<h3 id="Pacemaker"><a href="#Pacemaker" class="headerlink" title="Pacemaker"></a>Pacemaker</h3><p><code>Pacemaker</code> service manages core containers and services, such as Galera, RabbitMQ, Redis, and HAProxy.</p>
<p>It could monitor services as well as allocate the defected services to an available node, switch to a new node or restart the service.</p>
<h3 id="Ceph-MON-and-MDS"><a href="#Ceph-MON-and-MDS" class="headerlink" title="Ceph MON and MDS"></a>Ceph MON and MDS</h3><p>MON and MDS are two core components for Ceph. </p>
<p><code>MON</code> is responsible for monitorting the status of the whole ceph cluster.</p>
<p><code>MDS</code> looks like a map which manages and stores the meta data, it records the configuration information.</p>
<h3 id="NoVNC-and-SPICE"><a href="#NoVNC-and-SPICE" class="headerlink" title="NoVNC and SPICE"></a>NoVNC and SPICE</h3><p>OpenStack supports two protocols for providing remote virtual console access: <code>VNC(Virtual Network Computer)</code> and <code>SPICE(Simple Protocol for Independent Computing Environments)</code>.</p>
<ul>
<li><p>noVNC</p>
<p><code>noVNC</code> is comprised of a JavaScript library and an application that runs in desktop and mobile browsers using HTML5 and WebSockets.</p>
<p>It is a VNC client based on web, it is convenient for users to visit the virtual machine desktop by browser.</p>
</li>
<li><p>SPICE</p>
<p><code>SPICE</code> provides more advanced features than existing VNC clients.(audio or vedio)</p>
<blockquote>
<p>Red Hat recommends that you use a standalone SPICE client to access OpenStack instances from the private management network.</p>
</blockquote>
</li>
</ul>
<h2 id="Using-VNC-to-Access-an-Instance-Console"><a href="#Using-VNC-to-Access-an-Instance-Console" class="headerlink" title="Using VNC to Access an Instance Console"></a>Using VNC to Access an Instance Console</h2><p>Because all virtual machines are generated on the compute node, <code>each compute node</code> runs a <code>vncserver</code> process, listening on the internal API network on one or more ports, starting at 5900 and increasing, depending on the number of instances deployed on that compute node.</p>
<p><code>Each controller node</code> runs a <code>novncproxy</code> process, listening on port 6080 on the same internal API network. </p>
<p>The remaining services belong to the <code>Compute Service (Nova)</code> with components on <code>both the controller and compute nodes</code>.</p>
<p><img src="/../images/VNC_process.png" alt="VNC process"></p>
<p>VNC Process Flow for Accessing an Instance Console:</p>
<ol>
<li><p>Users make a request from <code>browser</code>.</p>
<p> Users open a browser and use the NoVNC plugin, call the nova-api (the main controller of OpenStack, residing on the controller node and listening on port 8774) to connect to the virtual machine. At this point, OpenStack’s Dashboard (the management interface) forwards the request via HAProxy (a highly capable traffic coordinator located on the controller node, using port 80).</p>
</li>
<li><p><code>Nova API</code> passes the request.</p>
<p> Nova-api passes a <code>get_vnc_console</code> request to nova-compute (compute, internal_API,AMQP).</p>
</li>
<li><p><code>Nova-compute</code> ask <code>libvirt</code>.</p>
<p> nova-compute passes the <code>get_vnc_console</code> request to libvirt (compute) to locate the VM’s attributes.</p>
</li>
<li><p><code>libvirt</code> generates a token.</p>
<p> libvirt generates a <code>token</code> from the VM’s UUID and returns the token to nova-compute (compute, internal_API, AMQP).</p>
<p> The token is like the ID-card of the VMs.</p>
</li>
<li><p><code>Nova-compute</code> returns the token to <code>Nova API</code>.</p>
<p> nova-compute returns the generated token and a <code>connect_info</code> object to nova-api (controller, internal API, AMQP).</p>
</li>
<li><p><code>Nova API</code> asks <code>Nova-consoleauth</code> to authorize.</p>
<p> <code>nova-api</code> passes an <code>authorize_console</code> request to <code>nova-consoleauth</code> (compute, internal API, AMQP), which caches the <code>connect_info</code> object, using the token as the index, for future use when the actual connection request occurs.</p>
</li>
<li><p><code>Nova API</code> tells the browser.</p>
<p> <code>nova-api</code> also returns a <code>nova-novncproxy URL</code> and the <code>instance-specific token</code> to the <code>browser</code> (workstation, external).</p>
</li>
<li><p><code>Browser</code> visit the <code>nova-novncproxy</code> by <code>haproxy</code>.</p>
<p> The browser (workstation, external) connects to the URL, <code>proxied by the dashboard haproxy</code> (controller, external, port 6080) to reach nova-novncproxy (controller, internal API, port 6080).</p>
</li>
<li><p><code>Nova-novncproxy</code> parses the token.</p>
<p> nova-novncproxy obtains the request and then it parses the <code>token and instance ID</code> from the URL and passes it to <code>nova-consoleauth</code> (controller, internal API, AMQP) to verify.</p>
</li>
<li><p><code>Nova-consoleauth</code> gives the feedback.</p>
<p>  Using the token, <code>nova-consoleauth</code> retrieves the <code>connect_info</code> object from the cache and <code>returns it to nova-novncproxy</code> (controller, internal API).</p>
</li>
<li><p><code>Nova-novncproxy</code> connects to the <code>VNC</code> server.</p>
<p>  <code>nova-novncproxy</code> connects directly to <code>vncserver</code> (compute, internal API, 5900+) at the port designated for the requested VM and creates a reverse proxy configuration by using <code>connect_info</code>.</p>
</li>
<li><p><code>The graphic web UI</code> will be sent to the <code>browser</code>.</p>
<p><code>nova-novncproxy</code> sends the <code>console graphics</code> back through the dashboard <code>haproxy</code> to the user’s <code>browser</code> (workstation, external).</p>
</li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://www.sunhaoyang.net">Haoyang Sun</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://www.sunhaoyang.net/Cloud/OpenStack/Identifying-shared-services-and-VNC/index.html">https://www.sunhaoyang.net/Cloud/OpenStack/Identifying-shared-services-and-VNC/index.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">This article is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. Please attribute the original author and source when sharing.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/OpenStack/">OpenStack</a></div><div class="post-share"><div class="social-share" data-image="https://blog.sunhaoyang.net/images/OpenStack.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="/pluginsSrc/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="/pluginsSrc/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>Buy Me a Coffee</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://blog.sunhaoyang.net/images/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="https://blog.sunhaoyang.net/images/wechat.jpg" alt="Wechat"/></a><div class="post-qr-code-desc">Wechat</div></li><li class="reward-item"><a href="https://blog.sunhaoyang.net/images/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="https://blog.sunhaoyang.net/images/alipay.jpg" alt="Alipay"/></a><div class="post-qr-code-desc">Alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/Cloud/OpenStack/Introducing-Component-Communication-RabbitMQ.html" title="OpenStack Series Chapter5: Introducing Component Communiation---RabbitMQ"><img class="cover" src="https://blog.sunhaoyang.net/images/OpenStack.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">OpenStack Series Chapter5: Introducing Component Communiation---RabbitMQ</div></div><div class="info-2"><div class="info-item-1">Let's discuss RabbitMQ, a message broker that can be used to communicate between different components in an OpenStack environment.</div></div></div></a><a class="pagination-related" href="/Linux/Mount/cifs-mount-attention/index.html" title="cifs mount attention"><img class="cover" src="https://blog.sunhaoyang.net/images/Mount.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">cifs mount attention</div></div><div class="info-2"><div class="info-item-1">The purpose of this article is just recording the errors about cifs-mount.</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/Cloud/OpenStack/Using-ReaR-to-back-up-OpenStack/index.html" title="OpenStack Series Chapter6: Using ReaR to back Up OpenStack"><img class="cover" src="https://blog.sunhaoyang.net/images/OpenStack.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-15</div><div class="info-item-2">OpenStack Series Chapter6: Using ReaR to back Up OpenStack</div></div><div class="info-2"><div class="info-item-1">I intend to introduce how to use ReaR to back up and restore OpenStack.</div></div></div></a><a class="pagination-related" href="/Cloud/OpenStack/Introducing-Component-Communication-RabbitMQ.html" title="OpenStack Series Chapter5: Introducing Component Communiation---RabbitMQ"><img class="cover" src="https://blog.sunhaoyang.net/images/OpenStack.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-09</div><div class="info-item-2">OpenStack Series Chapter5: Introducing Component Communiation---RabbitMQ</div></div><div class="info-2"><div class="info-item-1">Let's discuss RabbitMQ, a message broker that can be used to communicate between different components in an OpenStack environment.</div></div></div></a><a class="pagination-related" href="/Cloud/OpenStack/Openstack-Deployment-Overview/index.html" title="Openstack Deployment Series Chapter0:Overview"><img class="cover" src="https://blog.sunhaoyang.net/images/OpenStack.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-06</div><div class="info-item-2">Openstack Deployment Series Chapter0:Overview</div></div><div class="info-2"><div class="info-item-1">This deployment uses a fully manual approach, with the aim of helping everyone understand the deployment details and how the components work together.</div></div></div></a><a class="pagination-related" href="/Cloud/OpenStack/Introducing-Overcloud/index.html" title="OpenStack Series Chapter3:Introducing Overcloud"><img class="cover" src="https://blog.sunhaoyang.net/images/OpenStack.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-06</div><div class="info-item-2">OpenStack Series Chapter3:Introducing Overcloud</div></div><div class="info-2"><div class="info-item-1">Similarly, Let's understand the core Red Hat OpenStack components, manage overcloud services, and view the overcloud structure in this Chapter.</div></div></div></a><a class="pagination-related" href="/Cloud/OpenStack/Introducing-Undercloud/index.html" title="OpenStack Series Chapter2:Introducing Undercloud"><img class="cover" src="https://blog.sunhaoyang.net/images/OpenStack.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-30</div><div class="info-item-2">OpenStack Series Chapter2:Introducing Undercloud</div></div><div class="info-2"><div class="info-item-1">Let's understand the core Red Hat OpenStack components, manage undercloud services, and view the undercloud structure in this Chapter.</div></div></div></a><a class="pagination-related" href="/Cloud/OpenStack/Introducing-Containerized-Services/index.html" title="OpenStack Series Chapter1:Introducing Containerized Services"><img class="cover" src="https://blog.sunhaoyang.net/images/OpenStack.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-29</div><div class="info-item-2">OpenStack Series Chapter1:Introducing Containerized Services</div></div><div class="info-2"><div class="info-item-1">This article provides a detailed introduction to how the main services of OpenStack run in containers through TripleO. It covers the relevant container commands in detail, as well as how to manage container services using systemd.</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comments</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://blog.sunhaoyang.net/images/myphoto.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Haoyang Sun</div><div class="author-info-description">DevOps Engineer, Cloud-native Engineer, Open-source technology enthusiast</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">39</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content"><div class="center-content" style="text-align: center;">
    <p>My blog is now live!</p>
    <p>Hello everyone! Thank you for visiting my blog!</p>
    <p>Here, I will share my thoughts and reflections on various technologies and aspects of life.</p>
    <p>Please stay tuned for updates!:)</p>
    <p>If you’re interested in discussing any topic with me, feel free to leave a comment or reach out through the contact information provided below.</p>
    <p>Email: Flash_shy@163.com</p>
    <p>QQ ID: 1135300457</p>
    <p>Wechat ID: Flash_sunhy</p>
</div>
</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Shared-Services-Overview"><span class="toc-number">1.</span> <span class="toc-text">Shared Services Overview</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MariaDB"><span class="toc-number">1.1.</span> <span class="toc-text">MariaDB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis"><span class="toc-number">1.2.</span> <span class="toc-text">Redis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Memcached"><span class="toc-number">1.3.</span> <span class="toc-text">Memcached</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pacemaker"><span class="toc-number">1.4.</span> <span class="toc-text">Pacemaker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ceph-MON-and-MDS"><span class="toc-number">1.5.</span> <span class="toc-text">Ceph MON and MDS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NoVNC-and-SPICE"><span class="toc-number">1.6.</span> <span class="toc-text">NoVNC and SPICE</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Using-VNC-to-Access-an-Instance-Console"><span class="toc-number">2.</span> <span class="toc-text">Using VNC to Access an Instance Console</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/Cloud/OpenStack/Using-ReaR-to-back-up-OpenStack/index.html" title="OpenStack Series Chapter6: Using ReaR to back Up OpenStack"><img src="https://blog.sunhaoyang.net/images/OpenStack.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OpenStack Series Chapter6: Using ReaR to back Up OpenStack"/></a><div class="content"><a class="title" href="/Cloud/OpenStack/Using-ReaR-to-back-up-OpenStack/index.html" title="OpenStack Series Chapter6: Using ReaR to back Up OpenStack">OpenStack Series Chapter6: Using ReaR to back Up OpenStack</a><time datetime="2025-05-15T12:14:05.000Z" title="Created 2025-05-15 20:14:05">2025-05-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Cloud/OpenStack/Introducing-Component-Communication-RabbitMQ.html" title="OpenStack Series Chapter5: Introducing Component Communiation---RabbitMQ"><img src="https://blog.sunhaoyang.net/images/OpenStack.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OpenStack Series Chapter5: Introducing Component Communiation---RabbitMQ"/></a><div class="content"><a class="title" href="/Cloud/OpenStack/Introducing-Component-Communication-RabbitMQ.html" title="OpenStack Series Chapter5: Introducing Component Communiation---RabbitMQ">OpenStack Series Chapter5: Introducing Component Communiation---RabbitMQ</a><time datetime="2025-05-09T07:55:04.000Z" title="Created 2025-05-09 15:55:04">2025-05-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Cloud/OpenStack/Identifying-shared-services-and-VNC/index.html" title="OpenStack Series Chapter4: Identifying shared services and VNC"><img src="https://blog.sunhaoyang.net/images/OpenStack.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OpenStack Series Chapter4: Identifying shared services and VNC"/></a><div class="content"><a class="title" href="/Cloud/OpenStack/Identifying-shared-services-and-VNC/index.html" title="OpenStack Series Chapter4: Identifying shared services and VNC">OpenStack Series Chapter4: Identifying shared services and VNC</a><time datetime="2025-05-07T09:16:17.000Z" title="Created 2025-05-07 17:16:17">2025-05-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Linux/Mount/cifs-mount-attention/index.html" title="cifs mount attention"><img src="https://blog.sunhaoyang.net/images/Mount.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="cifs mount attention"/></a><div class="content"><a class="title" href="/Linux/Mount/cifs-mount-attention/index.html" title="cifs mount attention">cifs mount attention</a><time datetime="2025-05-07T05:12:46.000Z" title="Created 2025-05-07 13:12:46">2025-05-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Cloud/OpenStack/Openstack-Deployment-Overview/index.html" title="Openstack Deployment Series Chapter0:Overview"><img src="https://blog.sunhaoyang.net/images/OpenStack.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Openstack Deployment Series Chapter0:Overview"/></a><div class="content"><a class="title" href="/Cloud/OpenStack/Openstack-Deployment-Overview/index.html" title="Openstack Deployment Series Chapter0:Overview">Openstack Deployment Series Chapter0:Overview</a><time datetime="2025-05-06T15:25:18.000Z" title="Created 2025-05-06 23:25:18">2025-05-06</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://blog.sunhaoyang.net/images/footer_background.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By Haoyang Sun</div><div class="footer_custom_text"><a href="https://beian.mps.gov.cn/#/query/webSearch" target="_blank">
  <img src="https://blog.sunhaoyang.net/images/gonganbeian.png" alt="公安备案" style="vertical-align:middle; width:16px; heigh:16px;"> 辽公网安备21029602001011号
</a>
<a href="https://beian.miit.gov.cn/" rel="noreferrer" target="_blank">
  <img src="https://blog.sunhaoyang.net/images/icpbeian.png" alt="ICP备案" style="vertical-align:middle; width:16px; height:16px;"> 辽ICP备2025048274号-1
</a>
</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll to Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.sunhaoyang.net/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://twikoo.sunhaoyang.net/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    GLOBAL_CONFIG_SITE.isPost && getCount()

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('/pluginsSrc/twikoo/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script>window.newestComments = {
  changeContent: content => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[Image]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[Link]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[Code]') // replace code
    content = content.replace(/<code>.*?<\/code>/gi, '[Code]') // replace code      
    content = content.replace(/<[^>]+>/g, "") // remove html tag

    if (content.length > 150) {
      content = content.substring(0, 150) + '...'
    }
    return content
  },

  generateHtml: (array, ele) => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class="aside-list-item">'

        if (true && array[i].avatar) {
          const imgAttr = 'src'
          result += `<a href="${array[i].url}" class="thumbnail"><img ${imgAttr}="${array[i].avatar}" alt="${array[i].nick}"></a>`
        }

        result += `<div class="content">
        <a class="comment" href="${array[i].url}" title="${array[i].content}">${array[i].content}</a>
        <div class="name"><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += 'No comments'
    }

    ele.innerHTML = result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh(ele)
  },

  newestCommentInit: (name, getComment) => {
    const $dom = document.querySelector('#card-newest-comments .aside-list')
    if ($dom) {
      const data = btf.saveToLocal.get(name)
      if (data) {
        newestComments.generateHtml(JSON.parse(data), $dom)
      } else {
        getComment($dom)
      }
    }
  },

  run: (name, getComment) => {
    newestComments.newestCommentInit(name, getComment)
    btf.addGlobalFn('pjaxComplete', () => newestComments.newestCommentInit(name, getComment), name)
  }
}</script><script>window.addEventListener('load', () => {
  const keyName = 'twikoo-newest-comments'
  const { changeContent, generateHtml, run } = window.newestComments

  const getComment = ele => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://twikoo.sunhaoyang.net/',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(res => {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        btf.saveToLocal.set(keyName, JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray, ele)
      }).catch(err => {
        console.error(err)
        ele.textContent= "Unable to retrieve comments, please check the configuration"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      btf.getScript('/pluginsSrc/twikoo/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  run(keyName, getComment)
})</script><div class="aplayer no-destroy" data-id="7613104556" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="false"> </div><script defer="defer" id="fluttering_ribbon" mobile="true" src="/pluginsSrc/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="/pluginsSrc/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="/pluginsSrc/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="/pluginsSrc/aplayer/dist/APlayer.min.js"></script><script src="/pluginsSrc/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="/pluginsSrc/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      pjax.loadUrl('/404.html')
    }
  })
})()</script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>