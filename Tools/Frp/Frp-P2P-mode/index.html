<!DOCTYPE html><html lang="en-GB" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Frp P2P mode | Haoyang Sun's Blog</title><meta name="author" content="Haoyang Sun"><meta name="copyright" content="Haoyang Sun"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="This article explains how to use frp to create a P2P model, establishing a direct connection between two frpc servers through hole punching.">
<meta property="og:type" content="article">
<meta property="og:title" content="Frp P2P mode">
<meta property="og:url" content="https://www.sunhaoyang.net/Tools/Frp/Frp-P2P-mode/index.html">
<meta property="og:site_name" content="Haoyang Sun&#39;s Blog">
<meta property="og:description" content="This article explains how to use frp to create a P2P model, establishing a direct connection between two frpc servers through hole punching.">
<meta property="og:locale" content="en_GB">
<meta property="og:image" content="https://blog.sunhaoyang.net/images/Frp.png">
<meta property="article:published_time" content="2025-04-26T16:29:15.000Z">
<meta property="article:modified_time" content="2025-04-29T06:52:29.830Z">
<meta property="article:author" content="Haoyang Sun">
<meta property="article:tag" content="Frp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.sunhaoyang.net/images/Frp.png"><link rel="shortcut icon" href="https://blog.sunhaoyang.net/images/favicon.ico"><link rel="canonical" href="https://www.sunhaoyang.net/Tools/Frp/Frp-P2P-mode/index.html"><link rel="preconnect"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')
          
          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: '/pluginsSrc/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Frp P2P mode',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://blog.sunhaoyang.net/images/myphoto.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">39</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Homepage</span></a></div><div class="menus_item"><a class="site-page" href="/artitalk/"><i class="fa-fw fa fa-comment-alt"></i><span> Artitalk</span></a></div><div class="menus_item"><a class="site-page" href="/about"><i class="fa-fw fa-solid fa-user"></i><span> About the author</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Haoyang Sun's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Frp P2P mode</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Homepage</span></a></div><div class="menus_item"><a class="site-page" href="/artitalk/"><i class="fa-fw fa fa-comment-alt"></i><span> Artitalk</span></a></div><div class="menus_item"><a class="site-page" href="/about"><i class="fa-fw fa-solid fa-user"></i><span> About the author</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">Frp P2P mode</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-04-26T16:29:15.000Z" title="Created 2025-04-27 00:29:15">2025-04-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-04-29T06:52:29.830Z" title="Updated 2025-04-29 14:52:29">2025-04-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Tools/">Tools</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>12mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">Comments:</span><a href="/Tools/Frp/Frp-P2P-mode/index.html#post-comment"><span id="twikoo-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div><article class="container post-content" id="article-container"><h2 id="P2P-Peer-to-Peer"><a href="#P2P-Peer-to-Peer" class="headerlink" title="P2P (Peer-to-Peer)"></a>P2P (Peer-to-Peer)</h2><p>P2P (Peer-to-Peer) is a type of network architecture in which all the nodes (typically computers) in the network are considered equal and can communicate directly with each other, sharing resources and data without the need for an intermediary server. This contrasts with the traditional client-server model, where clients request services from servers.</p>
<h2 id="Frps-configuration"><a href="#Frps-configuration" class="headerlink" title="Frps configuration"></a>Frps configuration</h2><p>Similarly as before, edit the <code>frps.toml</code> in the server end and add the following lines here. <code>WebServer</code> service and <code>auth.token</code> could be disabled as well, just follow your heart.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vim frps.toml</span><br><span class="line"></span><br><span class="line">bindPort = 7000</span><br><span class="line">auth.token = <span class="string">&quot;sunhaoyang&quot;</span></span><br><span class="line">webServer.addr = <span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line">webServer.port = 7500</span><br><span class="line">webServer.user = <span class="string">&quot;admin&quot;</span></span><br><span class="line">webServer.password = <span class="string">&quot;admin_password&quot;</span></span><br></pre></td></tr></table></figure>

<p>Then, Start frps on machine A.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; /etc/systemd/system/frps.service &lt;&lt;-<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=FRP Server Service</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">User=root</span><br><span class="line">ExecStart=/usr/local/bin/frp/frps -c /usr/local/bin/frp/frps.toml</span><br><span class="line">Restart=on-failure</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@frp-server ~]# systemctl daemon-reload</span><br><span class="line">[root@frp-server ~]# systemctl enable frps.service --now</span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/frps.service → /etc/systemd/system/frps.service.</span><br><span class="line">[root@frp-server ~]# systemctl status frps.service</span><br><span class="line">● frps.service - FRP Server Service</span><br><span class="line">     Loaded: loaded (/etc/systemd/system/frps.service; enabled; preset: disabled)</span><br><span class="line">     Active: active (running) since Fri 2025-04-25 16:06:45 CST; 4s ago</span><br><span class="line">   Main PID: 355286 (frps)</span><br><span class="line">      Tasks: 5 (limit: 12344)</span><br><span class="line">     Memory: 9.0M</span><br><span class="line">        CPU: 324ms</span><br><span class="line">     CGroup: /system.slice/frps.service</span><br><span class="line">             └─355286 /usr/local/bin/frp/frps -c /usr/local/bin/frp/frps.toml</span><br><span class="line"></span><br><span class="line">Apr 25 16:06:45 frp-server systemd[1]: Started FRP Server Service.</span><br><span class="line">Apr 25 16:06:45 frp-server frps[355286]: 2025-04-25 16:06:45.952 [I] [frps/root.go:105] frps uses config file: /usr/local/bin/frp/frps.toml</span><br><span class="line">Apr 25 16:06:46 frp-server frps[355286]: 2025-04-25 16:06:46.270 [I] [server/service.go:237] frps tcp listen on 0.0.0.0:7000</span><br><span class="line">Apr 25 16:06:46 frp-server frps[355286]: 2025-04-25 16:06:46.271 [I] [frps/root.go:114] frps started successfully</span><br><span class="line">Apr 25 16:06:46 frp-server frps[355286]: 2025-04-25 16:06:46.271 [I] [server/service.go:351] dashboard listen on 0.0.0.0:7500</span><br></pre></td></tr></table></figure>

<h2 id="Frpc-configuration"><a href="#Frpc-configuration" class="headerlink" title="Frpc configuration"></a>Frpc configuration</h2><h3 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h3><p>Start frpc on machine B, and expose the SSH port. Note that the remotePort field is removed.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-0-7-rockylinux ~]# mv frp_0.62.0_linux_amd64 /usr/local/bin/frp</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># frpc.toml</span><br><span class="line">serverAddr = &quot;x.x.x.x&quot;</span><br><span class="line">serverPort = 7000</span><br><span class="line"># set up a new stun server if the default one is not available.</span><br><span class="line"># natHoleStunServer = &quot;xxx&quot;</span><br><span class="line"></span><br><span class="line">[[proxies]]</span><br><span class="line">name = &quot;p2p_ssh&quot;</span><br><span class="line">type = &quot;xtcp&quot;</span><br><span class="line">secretKey = &quot;abcdefg&quot;</span><br><span class="line">localIP = &quot;127.0.0.1&quot;</span><br><span class="line">localPort = 22       # Here, I use ssh port as an example. Something else, such as 80(httpd) works as well.</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; /etc/systemd/system/frpc.service &lt;&lt;-<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=FRP Client Service</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">User=root</span><br><span class="line">ExecStart=/usr/local/bin/frp/frpc -c /usr/local/bin/frp/frpc.toml</span><br><span class="line">Restart=on-failure</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-0-7-rockylinux frp]# systemctl daemon-reload</span><br><span class="line">[root@VM-0-7-rockylinux frp]# systemctl enable frpc.service --now</span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/frpc.service → /etc/systemd/system/frpc.service.</span><br><span class="line">[root@VM-0-7-rockylinux frp]# systemctl status frpc.service</span><br><span class="line">● frpc.service - FRP Client Service</span><br><span class="line">     Loaded: loaded (/etc/systemd/system/frpc.service; enabled; preset: disabled)</span><br><span class="line">     Active: active (running) since Sun 2025-04-27 00:57:13 CST; 3s ago</span><br><span class="line">   Main PID: 72540 (frpc)</span><br><span class="line">      Tasks: 4 (limit: 12140)</span><br><span class="line">     Memory: 5.0M</span><br><span class="line">        CPU: 6ms</span><br><span class="line">     CGroup: /system.slice/frpc.service</span><br><span class="line">             └─72540 /usr/local/bin/frp/frpc -c /usr/local/bin/frp/frpc.toml</span><br><span class="line"></span><br><span class="line">Apr 27 00:57:13 VM-0-7-rockylinux systemd[1]: Started FRP Client Service.</span><br><span class="line">Apr 27 00:57:13 VM-0-7-rockylinux frpc[72540]: 2025-04-27 00:57:13.009 [I] [sub/root.go:149] s&gt;</span><br><span class="line">Apr 27 00:57:13 VM-0-7-rockylinux frpc[72540]: 2025-04-27 00:57:13.009 [I] [client/service.go:&gt;</span><br><span class="line">Apr 27 00:57:13 VM-0-7-rockylinux frpc[72540]: 2025-04-27 00:57:13.042 [I] [client/service.go:&gt;</span><br><span class="line">Apr 27 00:57:13 VM-0-7-rockylinux frpc[72540]: 2025-04-27 00:57:13.042 [I] [proxy/proxy_manage&gt;</span><br><span class="line">Apr 27 00:57:13 VM-0-7-rockylinux frpc[72540]: 2025-04-27 00:57:13.052 [I] [client/control.go:&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Visitor"><a href="#Visitor" class="headerlink" title="Visitor"></a>Visitor</h3><p>Start another frpc (typically on another machine C) with the configuration to connect to SSH using P2P mode.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-48-7-rockylinux ~]# mv frp_0.62.0_linux_amd64 /usr/local/bin/frp</span><br><span class="line">[root@VM-48-7-rockylinux ~]# cd /usr/local/bin/</span><br><span class="line">[root@VM-48-7-rockylinux bin]# ls</span><br><span class="line">frp  scp  sftp  ssh  ssh-add  ssh-agent  ssh-keygen  ssh-keyscan</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># frpc.toml</span><br><span class="line">serverAddr = &quot;x.x.x.x&quot;</span><br><span class="line">serverPort = 7000</span><br><span class="line"># set up a new stun server if the default one is not available.</span><br><span class="line"># natHoleStunServer = &quot;xxx&quot;</span><br><span class="line"></span><br><span class="line">[[visitors]]</span><br><span class="line">name = &quot;p2p_ssh_visitor&quot;</span><br><span class="line">type = &quot;xtcp&quot;</span><br><span class="line">serverName = &quot;p2p_ssh&quot;      # The serverName here and that one in Proxy must be set to the same.</span><br><span class="line">secretKey = &quot;abcdefg&quot;       # The secretKey here and that one in Proxy must be set to the same.</span><br><span class="line">bindAddr = &quot;127.0.0.1&quot;</span><br><span class="line">bindPort = 6000</span><br><span class="line"># when automatic tunnel persistence is required, set it to true</span><br><span class="line"># keepTunnelOpen = false    # Comment this line</span><br></pre></td></tr></table></figure>

<h2 id="Connect"><a href="#Connect" class="headerlink" title="Connect"></a>Connect</h2><p>On machine C, connect to SSH on machine B, using this command.</p>
<h3 id="Login-Successfully"><a href="#Login-Successfully" class="headerlink" title="Login Successfully"></a>Login Successfully</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-48-7-rockylinux frp_0.62.0_linux_amd64]# ssh -oPort=6000 127.0.0.1</span><br><span class="line">root@127.0.0.1&#x27;s password: </span><br><span class="line">Activate the web console with: systemctl enable --now cockpit.socket</span><br><span class="line"></span><br><span class="line">Last login: Sat Apr 26 21:30:24 2025 from 175.162.122.18</span><br><span class="line">[root@VM-0-7-rockylinux ~]# </span><br></pre></td></tr></table></figure>

<h3 id="Check-the-log-of-frpc-in-machine-B"><a href="#Check-the-log-of-frpc-in-machine-B" class="headerlink" title="Check the log of frpc in machine B"></a>Check the log of frpc in machine B</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-0-7-rockylinux frp]# systemctl status frpc.service</span><br><span class="line">● frpc.service - FRP Client Service</span><br><span class="line">     Loaded: loaded (/etc/systemd/system/frpc.service; enabled; preset: disabled)</span><br><span class="line">     Active: active (running) since Sun 2025-04-27 00:57:13 CST; 10min ago</span><br><span class="line">   Main PID: 72540 (frpc)</span><br><span class="line">      Tasks: 4 (limit: 12140)</span><br><span class="line">     Memory: 8.1M</span><br><span class="line">        CPU: 451ms</span><br><span class="line">     CGroup: /system.slice/frpc.service</span><br><span class="line">             └─72540 /usr/local/bin/frp/frpc -c /usr/local/bin/frp/frpc.toml</span><br><span class="line"></span><br><span class="line">Apr 27 00:57:13 VM-0-7-rockylinux systemd[1]: Started FRP Client Service.</span><br><span class="line">Apr 27 00:57:13 VM-0-7-rockylinux frpc[72540]: 2025-04-27 00:57:13.009 [I] [sub/root.go:149] start frpc service for config file [/usr/local/bin/frp/frpc.toml]</span><br><span class="line">Apr 27 00:57:13 VM-0-7-rockylinux frpc[72540]: 2025-04-27 00:57:13.009 [I] [client/service.go:314] try to connect to server...</span><br><span class="line">Apr 27 00:57:13 VM-0-7-rockylinux frpc[72540]: 2025-04-27 00:57:13.042 [I] [client/service.go:306] [5dbff11603bd8e75] login to server success, get run id [5dbff11603bd&gt;</span><br><span class="line">Apr 27 00:57:13 VM-0-7-rockylinux frpc[72540]: 2025-04-27 00:57:13.042 [I] [proxy/proxy_manager.go:177] [5dbff11603bd8e75] proxy added: [p2p_ssh]</span><br><span class="line">Apr 27 00:57:13 VM-0-7-rockylinux frpc[72540]: 2025-04-27 00:57:13.052 [I] [client/control.go:172] [5dbff11603bd8e75] [p2p_ssh] start proxy success</span><br><span class="line">Apr 27 01:07:43 VM-0-7-rockylinux frpc[72540]: 2025-04-27 01:07:43.686 [I] [proxy/xtcp.go:72] [5dbff11603bd8e75] [p2p_ssh] nathole prepare success, nat type: EasyNAT, &gt;</span><br><span class="line">Apr 27 01:07:44 VM-0-7-rockylinux frpc[72540]: 2025-04-27 01:07:44.696 [I] [proxy/xtcp.go:93] [5dbff11603bd8e75] [p2p_ssh] get natHoleRespMsg, sid [17456872631ee7cb59a&gt;</span><br><span class="line">Apr 27 01:07:44 VM-0-7-rockylinux frpc[72540]: 2025-04-27 01:07:44.734 [I] [proxy/xtcp.go:109] [5dbff11603bd8e75] [p2p_ssh] establishing nat hole connection successful&gt;</span><br></pre></td></tr></table></figure>

<p>It is obviously that the hole was punched.<br>E.g. <code>nathole prepare success, nat type: EasyNAT</code>, <code>establishing nat hole connection successful</code>.</p>
<h3 id="Check-the-log-of-frps-in-machine-A"><a href="#Check-the-log-of-frps-in-machine-A" class="headerlink" title="Check the log of frps in machine A"></a>Check the log of frps in machine A</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2025-04-27 00:57:13.038 [I] [server/service.go:582] [5dbff11603bd8e75] client login info: ip [118.195.155.132:42178] version [0.62.0] hostname [] os [linux] arch [amd64]</span><br><span class="line">2025-04-27 00:57:13.049 [I] [server/control.go:399] [5dbff11603bd8e75] new proxy [p2p_ssh] type [xtcp] success</span><br><span class="line">2025-04-27 01:00:45.040 [I] [server/control.go:357] [607581f620a645ec] client exit success</span><br><span class="line">2025-04-27 01:01:34.544 [I] [server/service.go:582] [fc60898a7eda2cb0] client login info: ip [101.43.210.253:57136] version [0.62.0] hostname [] os [linux] arch [amd64]</span><br><span class="line">2025-04-27 01:07:44.741 [I] [nathole/controller.go:280] sid [17456872631ee7cb59a2e4b72a] report make hole success: true, mode 0, index 0</span><br></pre></td></tr></table></figure>

<p><code>report make hole success</code> represents the connection between machine B and machine C is successful as well.</p>
<h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><h3 id="scp"><a href="#scp" class="headerlink" title="scp"></a>scp</h3><h4 id="Create-a-large-file-by-dd-command-in-machine-C"><a href="#Create-a-large-file-by-dd-command-in-machine-C" class="headerlink" title="Create a large file by dd command in machine C"></a>Create a large file by <code>dd</code> command in machine C</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-0-7-rockylinux html]# dd if=/dev/zero of=testfile bs=1M count=5120</span><br><span class="line">5120+0 records in</span><br><span class="line">5120+0 records out</span><br><span class="line">5368709120 bytes (5.4 GB, 5.0 GiB) copied, 25.0375 s, 214 MB/s</span><br></pre></td></tr></table></figure>

<h4 id="Use-scp-command-in-machine-C-and-send-the-large-file-to-machine-B"><a href="#Use-scp-command-in-machine-C-and-send-the-large-file-to-machine-B" class="headerlink" title="Use scp command in machine C and send the large file to machine B"></a>Use <code>scp</code> command in machine C and send the large file to machine B</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-48-7-rockylinux ~]# time scp -P 6000 testfile root@127.0.0.1:/root</span><br><span class="line">root@127.0.0.1&#x27;s password: </span><br><span class="line">testfile                                                      53% 2749MB  10.5MB/s   03:45 ETA^C</span><br></pre></td></tr></table></figure>

<p><img src="/../images/frps_traffic_monitor.png" alt="frps traffic monitor"></p>
<p>Congratulations! This image is an evidence to proof that The traffic did not go through the <code>frps</code> server, but instead, machine B and machine C are <code>directly connected</code>.</p>
<h3 id="wget"><a href="#wget" class="headerlink" title="wget"></a>wget</h3><h4 id="Install-the-httpd-service-in-machine-B"><a href="#Install-the-httpd-service-in-machine-B" class="headerlink" title="Install the httpd service in machine B"></a>Install the <code>httpd</code> service in machine B</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dnf provides httpd</span><br><span class="line">dnf install httpd</span><br></pre></td></tr></table></figure>

<h4 id="Start-and-Enable-the-httpd-service-in-machine-B"><a href="#Start-and-Enable-the-httpd-service-in-machine-B" class="headerlink" title="Start and Enable the httpd service in machine B"></a>Start and Enable the <code>httpd</code> service in machine B</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-0-7-rockylinux ~]# systemctl enable httpd.service --now</span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/httpd.service → /usr/lib/systemd/system/httpd.service.</span><br><span class="line">[root@VM-0-7-rockylinux ~]# systemctl status httpd.service </span><br><span class="line">● httpd.service - The Apache HTTP Server</span><br><span class="line">     Loaded: loaded (/usr/lib/systemd/system/httpd.service; enabled; preset: disabled)</span><br><span class="line">     Active: active (running) since Sat 2025-04-26 22:11:58 CST; 1s ago</span><br><span class="line">       Docs: man:httpd.service(8)</span><br><span class="line">   Main PID: 21890 (httpd)</span><br><span class="line">     Status: &quot;Started, listening on: port 80&quot;</span><br><span class="line">      Tasks: 177 (limit: 12140)</span><br><span class="line">     Memory: 24.2M</span><br><span class="line">        CPU: 47ms</span><br><span class="line">     CGroup: /system.slice/httpd.service</span><br><span class="line">             ├─21890 /usr/sbin/httpd -DFOREGROUND</span><br><span class="line">             ├─21891 /usr/sbin/httpd -DFOREGROUND</span><br><span class="line">             ├─21892 /usr/sbin/httpd -DFOREGROUND</span><br><span class="line">             ├─21893 /usr/sbin/httpd -DFOREGROUND</span><br><span class="line">             └─21894 /usr/sbin/httpd -DFOREGROUND</span><br><span class="line"></span><br><span class="line">Apr 26 22:11:58 VM-0-7-rockylinux systemd[1]: Starting The Apache HTTP Server...</span><br><span class="line">Apr 26 22:11:58 VM-0-7-rockylinux httpd[21890]: Server configured, listening on: port 80</span><br><span class="line">Apr 26 22:11:58 VM-0-7-rockylinux systemd[1]: Started The Apache HTTP Server.</span><br></pre></td></tr></table></figure>

<h4 id="Create-a-large-file-by-dd-command-in-machine-B"><a href="#Create-a-large-file-by-dd-command-in-machine-B" class="headerlink" title="Create a large file by dd command in machine B"></a>Create a large file by <code>dd</code> command in machine B</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-0-7-rockylinux html]# dd if=/dev/zero of=testfile bs=1M count=5120</span><br><span class="line">5120+0 records in</span><br><span class="line">5120+0 records out</span><br><span class="line">5368709120 bytes (5.4 GB, 5.0 GiB) copied, 25.0375 s, 214 MB/s</span><br></pre></td></tr></table></figure>

<h4 id="Move-the-large-file-to-the-httpd-root-directory-in-machine-B"><a href="#Move-the-large-file-to-the-httpd-root-directory-in-machine-B" class="headerlink" title="Move the large file to the httpd root directory in machine B"></a>Move the large file to the httpd root directory in machine B</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv testfile /var/www/html</span><br></pre></td></tr></table></figure>

<h4 id="Use-wget-command-in-machine-C-and-download-the-large-file-from-machine-B"><a href="#Use-wget-command-in-machine-C-and-download-the-large-file-from-machine-B" class="headerlink" title="Use wget command in machine C and download the large file from machine B"></a>Use <code>wget</code> command in machine C and download the large file from machine B</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-48-7-rockylinux test_http]# wget http://127.0.0.1:6000/testfile</span><br><span class="line">--2025-04-26 22:17:00--  http://127.0.0.1:6000/testfile</span><br><span class="line">Connecting to 127.0.0.1:6000... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 5368709120 (5.0G)</span><br><span class="line">Saving to: ‘testfile.1’</span><br><span class="line">testfile.1               10%[==&gt;                            ] 529.66M  11.6MB/s    eta 6m 47s ^C</span><br></pre></td></tr></table></figure>

<p><img src="/../images/frps_traffic_monitor.png" alt="frps traffic monitor"></p>
<p>Congratulations! This image is an evidence to proof that The traffic did not go through the <code>frps</code> server, but instead, machine B and machine C are <code>directly connected</code>.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://www.sunhaoyang.net">Haoyang Sun</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://www.sunhaoyang.net/Tools/Frp/Frp-P2P-mode/index.html">https://www.sunhaoyang.net/Tools/Frp/Frp-P2P-mode/index.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">This article is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. Please attribute the original author and source when sharing.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Frp/">Frp</a></div><div class="post-share"><div class="social-share" data-image="https://blog.sunhaoyang.net/images/Frp.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="/pluginsSrc/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="/pluginsSrc/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>Buy Me a Coffee</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://blog.sunhaoyang.net/images/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="https://blog.sunhaoyang.net/images/wechat.jpg" alt="Wechat"/></a><div class="post-qr-code-desc">Wechat</div></li><li class="reward-item"><a href="https://blog.sunhaoyang.net/images/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="https://blog.sunhaoyang.net/images/alipay.jpg" alt="Alipay"/></a><div class="post-qr-code-desc">Alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/Cloud/OpenStack/Introducing-Containerized-Services/index.html" title="OpenStack Series Chapter1:Introducing Containerized Services"><img class="cover" src="https://blog.sunhaoyang.net/images/OpenStack.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">OpenStack Series Chapter1:Introducing Containerized Services</div></div><div class="info-2"><div class="info-item-1">This article provides a detailed introduction to how the main services of OpenStack run in containers through TripleO. It covers the relevant container commands in detail, as well as how to manage container services using systemd.</div></div></div></a><a class="pagination-related" href="/Tools/Frp/Frp-supplementation-and-improvement/index.html" title="Frp supplementation and improvement"><img class="cover" src="https://blog.sunhaoyang.net/images/Frp.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Frp supplementation and improvement</div></div><div class="info-2"><div class="info-item-1">This article mainly provides supplements for areas prone to errors and improves the usage of frp.</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/Tools/Frp/Frp-supplementation-and-improvement/index.html" title="Frp supplementation and improvement"><img class="cover" src="https://blog.sunhaoyang.net/images/Frp.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-26</div><div class="info-item-2">Frp supplementation and improvement</div></div><div class="info-2"><div class="info-item-1">This article mainly provides supplements for areas prone to errors and improves the usage of frp.</div></div></div></a><a class="pagination-related" href="/Tools/Frp/Complete-Guide-to-Use-Frp/index.html" title="Complete Guide to Use Frp"><img class="cover" src="https://blog.sunhaoyang.net/images/Frp.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-23</div><div class="info-item-2">Complete Guide to Use Frp</div></div><div class="info-2"><div class="info-item-1">Frp is primarily used to solve NAT and firewall issues, allowing external networks to access services located within the internal network.</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comments</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://blog.sunhaoyang.net/images/myphoto.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Haoyang Sun</div><div class="author-info-description">DevOps Engineer, Cloud-native Engineer, Open-source technology enthusiast</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">39</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content"><div class="center-content" style="text-align: center;">
    <p>My blog is now live!</p>
    <p>Hello everyone! Thank you for visiting my blog!</p>
    <p>Here, I will share my thoughts and reflections on various technologies and aspects of life.</p>
    <p>Please stay tuned for updates!:)</p>
    <p>If you’re interested in discussing any topic with me, feel free to leave a comment or reach out through the contact information provided below.</p>
    <p>Email: Flash_shy@163.com</p>
    <p>QQ ID: 1135300457</p>
    <p>Wechat ID: Flash_sunhy</p>
</div>
</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#P2P-Peer-to-Peer"><span class="toc-number">1.</span> <span class="toc-text">P2P (Peer-to-Peer)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Frps-configuration"><span class="toc-number">2.</span> <span class="toc-text">Frps configuration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Frpc-configuration"><span class="toc-number">3.</span> <span class="toc-text">Frpc configuration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Proxy"><span class="toc-number">3.1.</span> <span class="toc-text">Proxy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Visitor"><span class="toc-number">3.2.</span> <span class="toc-text">Visitor</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Connect"><span class="toc-number">4.</span> <span class="toc-text">Connect</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Login-Successfully"><span class="toc-number">4.1.</span> <span class="toc-text">Login Successfully</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Check-the-log-of-frpc-in-machine-B"><span class="toc-number">4.2.</span> <span class="toc-text">Check the log of frpc in machine B</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Check-the-log-of-frps-in-machine-A"><span class="toc-number">4.3.</span> <span class="toc-text">Check the log of frps in machine A</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Test"><span class="toc-number">5.</span> <span class="toc-text">Test</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#scp"><span class="toc-number">5.1.</span> <span class="toc-text">scp</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Create-a-large-file-by-dd-command-in-machine-C"><span class="toc-number">5.1.1.</span> <span class="toc-text">Create a large file by dd command in machine C</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Use-scp-command-in-machine-C-and-send-the-large-file-to-machine-B"><span class="toc-number">5.1.2.</span> <span class="toc-text">Use scp command in machine C and send the large file to machine B</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wget"><span class="toc-number">5.2.</span> <span class="toc-text">wget</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Install-the-httpd-service-in-machine-B"><span class="toc-number">5.2.1.</span> <span class="toc-text">Install the httpd service in machine B</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Start-and-Enable-the-httpd-service-in-machine-B"><span class="toc-number">5.2.2.</span> <span class="toc-text">Start and Enable the httpd service in machine B</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Create-a-large-file-by-dd-command-in-machine-B"><span class="toc-number">5.2.3.</span> <span class="toc-text">Create a large file by dd command in machine B</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Move-the-large-file-to-the-httpd-root-directory-in-machine-B"><span class="toc-number">5.2.4.</span> <span class="toc-text">Move the large file to the httpd root directory in machine B</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Use-wget-command-in-machine-C-and-download-the-large-file-from-machine-B"><span class="toc-number">5.2.5.</span> <span class="toc-text">Use wget command in machine C and download the large file from machine B</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/Cloud/OpenStack/Using-ReaR-to-back-up-OpenStack/index.html" title="OpenStack Series Chapter6: Using ReaR to back Up OpenStack"><img src="https://blog.sunhaoyang.net/images/OpenStack.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OpenStack Series Chapter6: Using ReaR to back Up OpenStack"/></a><div class="content"><a class="title" href="/Cloud/OpenStack/Using-ReaR-to-back-up-OpenStack/index.html" title="OpenStack Series Chapter6: Using ReaR to back Up OpenStack">OpenStack Series Chapter6: Using ReaR to back Up OpenStack</a><time datetime="2025-05-15T12:14:05.000Z" title="Created 2025-05-15 20:14:05">2025-05-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Cloud/OpenStack/Introducing-Component-Communication-RabbitMQ.html" title="OpenStack Series Chapter5: Introducing Component Communiation---RabbitMQ"><img src="https://blog.sunhaoyang.net/images/OpenStack.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OpenStack Series Chapter5: Introducing Component Communiation---RabbitMQ"/></a><div class="content"><a class="title" href="/Cloud/OpenStack/Introducing-Component-Communication-RabbitMQ.html" title="OpenStack Series Chapter5: Introducing Component Communiation---RabbitMQ">OpenStack Series Chapter5: Introducing Component Communiation---RabbitMQ</a><time datetime="2025-05-09T07:55:04.000Z" title="Created 2025-05-09 15:55:04">2025-05-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Cloud/OpenStack/Identifying-shared-services-and-VNC/index.html" title="OpenStack Series Chapter4: Identifying shared services and VNC"><img src="https://blog.sunhaoyang.net/images/OpenStack.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OpenStack Series Chapter4: Identifying shared services and VNC"/></a><div class="content"><a class="title" href="/Cloud/OpenStack/Identifying-shared-services-and-VNC/index.html" title="OpenStack Series Chapter4: Identifying shared services and VNC">OpenStack Series Chapter4: Identifying shared services and VNC</a><time datetime="2025-05-07T09:16:17.000Z" title="Created 2025-05-07 17:16:17">2025-05-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Linux/Mount/cifs-mount-attention/index.html" title="cifs mount attention"><img src="https://blog.sunhaoyang.net/images/Mount.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="cifs mount attention"/></a><div class="content"><a class="title" href="/Linux/Mount/cifs-mount-attention/index.html" title="cifs mount attention">cifs mount attention</a><time datetime="2025-05-07T05:12:46.000Z" title="Created 2025-05-07 13:12:46">2025-05-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Cloud/OpenStack/Openstack-Deployment-Overview/index.html" title="Openstack Deployment Series Chapter0:Overview"><img src="https://blog.sunhaoyang.net/images/OpenStack.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Openstack Deployment Series Chapter0:Overview"/></a><div class="content"><a class="title" href="/Cloud/OpenStack/Openstack-Deployment-Overview/index.html" title="Openstack Deployment Series Chapter0:Overview">Openstack Deployment Series Chapter0:Overview</a><time datetime="2025-05-06T15:25:18.000Z" title="Created 2025-05-06 23:25:18">2025-05-06</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://blog.sunhaoyang.net/images/footer_background.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By Haoyang Sun</div><div class="footer_custom_text"><a href="https://beian.mps.gov.cn/#/query/webSearch" target="_blank">
  <img src="https://blog.sunhaoyang.net/images/gonganbeian.png" alt="公安备案" style="vertical-align:middle; width:16px; heigh:16px;"> 辽公网安备21029602001011号
</a>
<a href="https://beian.miit.gov.cn/" rel="noreferrer" target="_blank">
  <img src="https://blog.sunhaoyang.net/images/icpbeian.png" alt="ICP备案" style="vertical-align:middle; width:16px; height:16px;"> 辽ICP备2025048274号-1
</a>
</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll to Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.sunhaoyang.net/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://twikoo.sunhaoyang.net/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    GLOBAL_CONFIG_SITE.isPost && getCount()

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('/pluginsSrc/twikoo/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script>window.newestComments = {
  changeContent: content => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[Image]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[Link]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[Code]') // replace code
    content = content.replace(/<code>.*?<\/code>/gi, '[Code]') // replace code      
    content = content.replace(/<[^>]+>/g, "") // remove html tag

    if (content.length > 150) {
      content = content.substring(0, 150) + '...'
    }
    return content
  },

  generateHtml: (array, ele) => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class="aside-list-item">'

        if (true && array[i].avatar) {
          const imgAttr = 'src'
          result += `<a href="${array[i].url}" class="thumbnail"><img ${imgAttr}="${array[i].avatar}" alt="${array[i].nick}"></a>`
        }

        result += `<div class="content">
        <a class="comment" href="${array[i].url}" title="${array[i].content}">${array[i].content}</a>
        <div class="name"><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += 'No comments'
    }

    ele.innerHTML = result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh(ele)
  },

  newestCommentInit: (name, getComment) => {
    const $dom = document.querySelector('#card-newest-comments .aside-list')
    if ($dom) {
      const data = btf.saveToLocal.get(name)
      if (data) {
        newestComments.generateHtml(JSON.parse(data), $dom)
      } else {
        getComment($dom)
      }
    }
  },

  run: (name, getComment) => {
    newestComments.newestCommentInit(name, getComment)
    btf.addGlobalFn('pjaxComplete', () => newestComments.newestCommentInit(name, getComment), name)
  }
}</script><script>window.addEventListener('load', () => {
  const keyName = 'twikoo-newest-comments'
  const { changeContent, generateHtml, run } = window.newestComments

  const getComment = ele => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://twikoo.sunhaoyang.net/',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(res => {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        btf.saveToLocal.set(keyName, JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray, ele)
      }).catch(err => {
        console.error(err)
        ele.textContent= "Unable to retrieve comments, please check the configuration"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      btf.getScript('/pluginsSrc/twikoo/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  run(keyName, getComment)
})</script><div class="aplayer no-destroy" data-id="7613104556" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="false"> </div><script defer="defer" id="fluttering_ribbon" mobile="true" src="/pluginsSrc/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="/pluginsSrc/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="/pluginsSrc/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="/pluginsSrc/aplayer/dist/APlayer.min.js"></script><script src="/pluginsSrc/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="/pluginsSrc/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      pjax.loadUrl('/404.html')
    }
  })
})()</script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>